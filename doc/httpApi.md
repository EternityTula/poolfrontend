# Common status values suitable for all operations

* ok: operation success
* json_format_error: request is not correct json or argument type mismatch
* request_format_error: invalid function arguments passed

# User management

## userCreate
Register new user and send email with activation link if parameter <poolfrontend.smtpEnabled> is "true" in pool config. Activation link format is http://<poolfrontend.poolHostAddress><poolfrontend.poolActivateLinkPrefix><actionId>, where poolfrontend.poolHostAddress and poolfrontend.poolActivateLinkPrefix defined in pool config; actionId: 512-bit unique identifier of operation, that can be user as input parameter of 'useraction' api.
Pool frontend must have a handler for configured activation link fornat.

### query type: POST
### arguments:
* login:string - Unique user identifier (up to 64 characters)
* password:string - Password (8-64 characters length)
* email:string - User email
* name:string - User name (display instead of login in 'blocks found by pool' table (up to 256 characters)

### return values:
* status:string - can be one of common status values or:
  * login_format_invalid
  * password_format_invalid
  * email_format_invalid
  * name_format_invalid
  * duplicate_email: already have another user with requested email
  * duplicate_login: already have user with requested login
  * smtp_client_create_error: internal error with SMTP protocol client
  * email_send_error: error received from SMTP server, details in pool log

### curl example:
```
curl -X POST -d "{\"login\": \"user\", \"password\": \"12345678\", \"email\": \"my@email.com\"}" http://localhost:18880/api/userCreate
```

### response examples:
```
{"status": "ok"}
```
```
{"status": "duplicate_email"}
```

### activation link format example:
```
http://localhost/actions/useracivate?id=6310abb30747f6498a5ec114fdfcc844babdbd9566bcc69e9a2472536a6a850892f339e0866215140497e186710cc15af5582de5e222e4e4a6089dcfd0270017
```

## userResendEmail
Create new user activation id and send it by email. Useful when first email with activation link not received by user.

### query type: POST
### arguments:
* login:string - Unique user identifier (up to 64 characters)
* password:string - Password (8-64 characters length)

### return values:
* status:string - can be one of common status values or:
  * invalid_password
  * user_already_active
  * smtp_client_create_error: internal error with SMTP protocol client
  * email_send_error: error received from SMTP server, details in pool log

### curl example:
```
curl -X POST -d "{\"login\": \"user\", \"password\": \"12345678\", \"email\": \"my@email.com\"}" http://localhost:18880/api/userResendEmail
```
### response examples:
```
{"status": "ok"}
```
```
{"status": "user_already_active"}
```

## userAction
Confirm various user actions, such as user activation, changing password, etc

### query type: POST
### arguments:
* id:string - unique identifier of operation generated by another api function

### return values:
* status:string - can be one of common status values or:
  * unknown_id: invalid or already activated id
  * unknown_login: internal error
  * user_already_active: internal error
  * unknown_type: internal error

### curl example:
```
curl -X POST -d "{\"id\": \"6310abb30747f6498a5ec114fdfcc844babdbd9566bcc69e9a2472536a6a850892f339e0866215140497e186710cc15af5582de5e222e4e4a6089dcfd0270017\"}" http://localhost:18880/api/userAction
```
### response examples:
```
{"status": "ok"}
```
```
{"status": "unknown_id"}
```

## userLogin
Log in procedure, function accepted login/password and returns session id unique for user

### query type: POST
### arguments:
* login:string
* password:string

### return values:
* sessionid:string: unique session identifier, needed for other api functions
* status:string - can be one of common status values or:
  * invalid_password: login/password mismatch
  * user_not_active: user registered, but not activated using special link sent to email

### curl example:
```
curl -X POST -d "{\"login\": \"user\", \"password\": \"12345678\"}" http://localhost:18880/api/userLogin
```
### responses examples:
```
{"sessionid": "863fe99ef908bc4ba7e954c381224f0370d8840ef6c653b14eba865caafb87c4aa2635312099a72aedc450c8dfa2d87e37641271d927c474b661afc73552d9fc","status": "ok"}
```
```
{"sessionid": "","status": "user_not_active"}
```
```
{"sessionId": "","status": "invalid_password"}
```

## userLogout
Close user session, invalidate session id

### query type: POST
### arguments:
* id:string - unique user session id returned by userlogin function

### return values:
* status:string - can be one of common status values or:
  * unknown_id: invalid session id

### curl example:
```
curl -X POST -d "{\"id\": \"d6c6a5b8839f4af4eac0e085a25d87efa27c56be6930763877a1410238d6d16b8e83f080719d7d0e6a0a7f927b257f39328ec67922dbdbf5a31c09d9e9413071\"}" http://localhost:18880/api/userLogout
```

### response examples:
```
{"status": "ok"}
```
```
{"status": "unknown_id"}
```

## userGetCredentials
Query user information

### query type: POST
### arguments:
* id:string - unique identifier of operation generated by another api function

### return values:
* status:string - can be one of common status values or:
  * unknown_id: invalid session id
* name:string
* email:string
* registrationDate:integer - uses unix time format

### curl example:
```
curl -X POST -d "{\"id\": \"f8cb3890197f7b4c981e0cec4d28125fca9ea28fe2928121184e1b3a7e4f28048606b6dcead1281b836dafcb540ca507c86d0e2066a595b6fc8c7c3509699c24\"}" http://localhost:18880/api/userGetCredentials
```

### response examples:
```
{"status": "ok","name": "user","email": "my@email.com","registrationDate": 1594539116}
```

## userGetSettings
Returns user payout settings for each coin

### query type: POST
### arguments
* id:string - unique user session id returned by userlogin function

### return values:
Array of JSON objects with these fields:

* status:string - can be one of common status values or:
  * unknown_id: invalid session id
* name:string - coin ticker
* address:string - payout address; can be null
* payoutThreshold:integer: minimal value for automatic payout; can be null
* autoPayoutEnabled:boolean - enables or disables automatic payouts

### curl example:
```
curl -X POST -d "{\"id\": \"d71f5e21d7273b268178d43a0df53449374b846d8043fbd0038a85182f499624fdc79db62d436b189f6a0f9e810a5620decf5e30edfcb2cdc9c63c13bebcd2e2\"}" http://localhost:18880/api/userGetSettings
```
### response examples:
```
{
   "status":"ok",
   "coins":[
      {
         "name":"BTC",
         "address":null,
         "payoutThreshold":null,
         "autoPayoutEnabled":false
      },
      {
         "name":"XPM",
         "address":"ATWDYBwVDvswyZADMbEo5yBt4tH2zfGjd1",
         "payoutThreshold":"100.00",
         "autoPayoutEnabled":true
      }
   ]
}
```

## userUpdateSettings
Update user payout settings for specific coin

### query type: POST
### arguments:
* id:string - unique user session id returned by userlogin function
* coin:string
* address:string
* payoutThreshold:string - minimal threshold for automatic payout
* autoPayoutEnabled:boolean - enable or disable automatic payouts

### return values:
* status:string - can be one of common status values or:
  * unknown_id: invalid session id

### curl example:
```
curl -X POST -d "{\"id\": \"147a30085b6f45a693e1dd2ec2c69642eb15df4fd53256111522c0ee1d63e0e68cfdb3c2a01c5be521abf3e51e00f29e86c49a059bdb842f9546304e8cadfef4\", \"coin\": \"XPM\", \"address\": \"ATWDYBwVDvswyZADMbEo5yBt4tH2zfGjd1\", \"payoutThreshold\": \"100\", \"autoPayoutEnabled\": true}" http://localhost:18880/api/userUpdateSettings
```
### response examples:
```
{"status": "ok"}
```
